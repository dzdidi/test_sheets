var assert = require('assert');
var mocha = require('mocha');
var sinon = require('sinon');
var scheme = require('../lib/scheme');
var descriptionSpy = sinon.spy(scheme, 'getDescription');
var moduleUnderTestSpy = sinon.spy(scheme, 'getModuleUnderTest');
var objectsUnderTestSpy = sinon.spy(scheme, 'getObjectsUnderTest');
var methodsUnderTestSpy = sinon.spy(scheme, 'getMethodsUnderTest');
var inputsSpy = sinon.spy(scheme, 'getInputs');
var outputsSpy = sinon.spy(scheme, 'getOutputs');
var testSheetObject = require('./doublers/basicSheetObject');

describe('Creation of Test Sheet scheme', function() {

  describe('getDescription function', function() {
    it('should have getDescription function', function(done) {
      assert.equal(typeof (scheme.getDescription), 'function');
      done();
    });

    it('should accept one parameter', function(done) {
      assert.equal(scheme.getDescription.length, 1);

      assert.throws(function() {
        scheme.getDescription();
      }, 'sheet has to be provided');

      done();
    });

    it('should return description feild from sheet', function(done) {
      assert.equal(scheme.getDescription(testSheetObject.Sheets.Sheet1), testSheetObject.basicScheme.description);

      done();
    });
  });

  describe('getModuleUnderTest function', function() {
    it('should have getModuleUnderTest function', function(done) {
      assert.equal(typeof (scheme.getModuleUnderTest), 'function');

      done();
    });

    it('should accept one parameter', function(done) {
      assert.equal(scheme.getModuleUnderTest.length, 1);

      assert.throws(function() {
        scheme.getModuleUnderTest();
      }, 'sheet has to be provided');

      done();
    });

    it('should return moduleUnderTest feild from sheet', function(done) {
      assert.equal(scheme.getModuleUnderTest(testSheetObject.Sheets.Sheet1), testSheetObject.basicScheme.moduleUnderTest);

      done();
    });
  });

  describe('getObjectsUnderTest function', function() {
    it('should have getObjectsUnderTest function', function(done) {
      assert.equal(typeof (scheme.getObjectsUnderTest), 'function');

      done();
    });

    it('should accept one parameter', function(done) {
      assert.equal(scheme.getObjectsUnderTest.length, 1);

      assert.throws(function() {
        scheme.getObjectsUnderTest();
      }, 'sheet has to be provided');

      done();
    });

    it('should return objects under test feilds from sheet', function(done) {
      assert.deepEqual(scheme.getObjectsUnderTest(testSheetObject.Sheets.Sheet1), testSheetObject.basicScheme.objectsUnderTest);

      done();
    });
  });

  describe('getMethodsUnderTest function', function() {
    it('should have getMethodsUnderTest function', function(done) {
      assert.equal(typeof (scheme.getMethodsUnderTest), 'function');

      done();
    });

    it('should accept one parameter', function(done) {
      assert.equal(scheme.getMethodsUnderTest.length, 1);

      assert.throws(function() {
        scheme.getMethodsUnderTest();
      }, 'sheet has to be provided');

      done();
    });

    it('should return methods under test feilds from sheet', function(done) {
      assert.deepEqual(scheme.getMethodsUnderTest(testSheetObject.Sheets.Sheet1), testSheetObject.basicScheme.methodsUnderTest);

      done();
    });
  });

  describe('getInputs function', function() {
    it('should have getInputs function', function(done) {
      assert.equal(typeof (scheme.getInputs), 'function');

      done();
    });

    it('should accept one parameter', function(done) {
      assert.equal(scheme.getInputs.length, 1);

      assert.throws(function() {
        scheme.getInputs();
      }, 'sheet has to be provided');

      done();
    });

    it('should return inputs feilds from sheet', function(done) {
      assert.deepEqual(scheme.getInputs(testSheetObject.Sheets.Sheet1), testSheetObject.basicScheme.inputs);

      done();
    });
  });

  describe('getOutputs function', function() {
    it('should have getOutputs function', function(done) {
      assert.equal(typeof (scheme.getOutputs), 'function');

      done();
    });

    it('should accept one parameter', function(done) {
      assert.equal(scheme.getOutputs.length, 1);

      assert.throws(function() {
        scheme.getOutputs();
      }, 'sheet has to be provided');

      done();
    });

    it('should return output feilds from sheet', function(done) {
      assert.deepEqual(scheme.getOutputs(testSheetObject.Sheets.Sheet1), testSheetObject.basicScheme.outputs);

      done();
    });
  });

  describe('getInvocationCells function', function() {
    it('should have getInvocationCells function', function() {
      assert.equal(typeof (scheme.getInvocationCells), 'function');
    });

    it('should accept one parameter', function(done) {
      assert.equal(scheme.getInvocationCells.length, 1);

      assert.throws(function() {
        scheme.getInvocationCells();
      }, 'sheet has to be provided');

      done();
    });

    it('should return keys of input where field \'v\' is equal to \'|\' or \'||\'', function(done) {
      var aInvocationCells = scheme.getInvocationCells(testSheetObject.Sheets.Sheet1);
      var eInvocationCells = testSheetObject.basicScheme.invocations;

      assert.deepEqual(aInvocationCells, eInvocationCells);

      done();
    });
  });
  describe('test coverage for transformScheme', function() {
    it('should have transformScheme function', function(done) {
      assert.equal(typeof scheme.transformScheme, 'function');

      done();
    });

    it('should accept one parameter', function(done) {
      assert.equal(scheme.transformScheme.length, 1);

      done();
    });

    it('should transform provided scheme to specific form', function(done) {
      assert.deepEqual(scheme.transformScheme(testSheetObject.basicScheme), testSheetObject.transformedScheme);

      done();
    });
  });

  describe('test coverage for getRowFromField', function() {
    it('should have getRowFromField function', function(done) {
      assert.equal(typeof scheme.getRowFromField, 'function');

      done();
    });

    it('should accept two parameters', function(done) {
      assert.equal(scheme.getRowFromField.length, 2);

      done();
    });

    it('should return all cells from same row in a specific feild', function(done) {
      assert.deepEqual(scheme.getRowFromField(testSheetObject.basicScheme.inputs, 5), testSheetObject.transformedScheme[5].inputs);
      done();
    });
  });
});
