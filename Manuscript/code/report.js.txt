function makeComparisonAndWriteResult(expected, returned, deepness, scriptName, file, variable){
  var result = compare(expected, returned, deepness);
  var res = "";
  result ? res = "#00FF00" : res = "#FFFF00";
  var testSheet = xlsx.readFile(file, {'cellStyles': true});
  var path = file.split('/');
  var resFile = "res_" + path[path.length - 1];
  path[path.length - 1] = resFile;
  var resPath = path.join('/');
  if(!result){
    testSheet.Sheets.Sheet1[variable].v = JSON.stringify(expected) + '\\' + JSON.stringify(returned);
    try {
      fs.writeFileSync(resPath, '', { flag: 'wx' });
    } catch (e) {
      if (e.code = 'EEXIST')
        xlsx.writeFile(testSheet, resPath, {'cellStyles': true});
    };
    xlsx.writeFile(testSheet, resPath, {'cellStyles': true});
  };

  return(result);
};
